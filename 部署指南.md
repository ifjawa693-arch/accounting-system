# ğŸš€ è´¢åŠ¡ä¼šè®¡ç³»ç»Ÿ - éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®](#æœ¬åœ°å¼€å‘)
2. [äº‘æœåŠ¡å™¨éƒ¨ç½²](#äº‘æœåŠ¡å™¨éƒ¨ç½²)
3. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æœ¬åœ°å¼€å‘

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…Node.js

**Windowsç³»ç»Ÿï¼š**
1. è®¿é—® https://nodejs.org/
2. ä¸‹è½½LTSç‰ˆæœ¬ï¼ˆæ¨è18.xæˆ–20.xï¼‰
3. åŒå‡»å®‰è£…ï¼Œä¸€è·¯Next
4. æ‰“å¼€CMDï¼Œè¾“å…¥éªŒè¯ï¼š
```bash
node --version
npm --version
```

### ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åç«¯

1. **å®‰è£…åç«¯ä¾èµ–**
```bash
cd backend
npm install
```

2. **å¯åŠ¨åç«¯æœåŠ¡**
```bash
npm start
```

çœ‹åˆ°è¿™ä¸ªå°±æˆåŠŸäº†ï¼š
```
ğŸš€ åç«¯æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼
ğŸ“¡ APIåœ°å€: http://localhost:3001
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®å‰ç«¯è¿æ¥åç«¯

å‰ç«¯å·²ç»é…ç½®å¥½APIåœ°å€ï¼Œç›´æ¥å¯åŠ¨å³å¯ï¼š

```bash
# å›åˆ°é¡¹ç›®æ ¹ç›®å½•
cd ..
npm run dev
```

æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:5173

---

## äº‘æœåŠ¡å™¨éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- æ“ä½œç³»ç»Ÿï¼šUbuntu 20.04 / CentOS 7+ 
- Node.jsï¼š18.x æˆ–æ›´é«˜
- å†…å­˜ï¼š1GB+
- ç£ç›˜ï¼š10GB+

### ç¬¬ä¸€æ­¥ï¼šè¿æ¥äº‘æœåŠ¡å™¨

```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

### ç¬¬äºŒæ­¥ï¼šå®‰è£…Node.js

**Ubuntu/Debianï¼š**
```bash
# æ›´æ–°åŒ…ç®¡ç†å™¨
sudo apt update

# å®‰è£…Node.js 18.x
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

**CentOSï¼š**
```bash
# å®‰è£…Node.js 18.x
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

### ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ ä»£ç 

**æ–¹æ³•1ï¼šä½¿ç”¨Gitï¼ˆæ¨èï¼‰**
```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /var/www
git clone ä½ çš„gitä»“åº“åœ°å€
cd accounting-system
```

**æ–¹æ³•2ï¼šä½¿ç”¨FTP/SFTP**
- ä½¿ç”¨FileZillaæˆ–WinSCP
- è¿æ¥æœåŠ¡å™¨
- ä¸Šä¼ æ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹

### ç¬¬å››æ­¥ï¼šå®‰è£…ä¾èµ–å’Œæ„å»º

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# æ„å»ºå‰ç«¯
npm run build

# å®‰è£…åç«¯ä¾èµ–
cd backend
npm install
```

### ç¬¬äº”æ­¥ï¼šå®‰è£…PM2ï¼ˆä¿æŒæœåŠ¡è¿è¡Œï¼‰

```bash
# å®‰è£…PM2
sudo npm install -g pm2

# å¯åŠ¨åç«¯æœåŠ¡
pm2 start server.js --name accounting-api

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
pm2 status

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

### ç¬¬å…­æ­¥ï¼šé…ç½®Nginx

**å®‰è£…Nginxï¼š**
```bash
sudo apt install nginx  # Ubuntu
# æˆ–
sudo yum install nginx  # CentOS
```

**é…ç½®Nginxï¼š**
```bash
sudo nano /etc/nginx/sites-available/accounting
```

ç²˜è´´ä»¥ä¸‹é…ç½®ï¼š
```nginx
server {
    listen 80;
    server_name ä½ çš„åŸŸåæˆ–IP;

    # å‰ç«¯é™æ€æ–‡ä»¶
    root /var/www/accounting-system/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # åç«¯APIä»£ç†
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

**å¯ç”¨é…ç½®ï¼š**
```bash
sudo ln -s /etc/nginx/sites-available/accounting /etc/nginx/sites-enabled/
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl restart nginx
```

### ç¬¬ä¸ƒæ­¥ï¼šé…ç½®é˜²ç«å¢™

```bash
# å¼€æ”¾80ç«¯å£ï¼ˆHTTPï¼‰
sudo ufw allow 80
sudo ufw allow 443  # å¦‚æœç”¨HTTPS

# é‡æ–°åŠ è½½é˜²ç«å¢™
sudo ufw reload
```

### ç¬¬å…«æ­¥ï¼šè®¿é—®ç³»ç»Ÿ

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
```
http://ä½ çš„æœåŠ¡å™¨IP
```

---

## ğŸ“ é‡è¦å‘½ä»¤

### PM2ç®¡ç†åç«¯

```bash
pm2 status              # æŸ¥çœ‹çŠ¶æ€
pm2 logs accounting-api # æŸ¥çœ‹æ—¥å¿—
pm2 restart accounting-api  # é‡å¯æœåŠ¡
pm2 stop accounting-api     # åœæ­¢æœåŠ¡
pm2 delete accounting-api   # åˆ é™¤æœåŠ¡
```

### Nginxç®¡ç†

```bash
sudo systemctl status nginx   # æŸ¥çœ‹çŠ¶æ€
sudo systemctl start nginx    # å¯åŠ¨
sudo systemctl stop nginx     # åœæ­¢
sudo systemctl restart nginx  # é‡å¯
sudo nginx -t                 # æµ‹è¯•é…ç½®
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# åç«¯æ—¥å¿—
pm2 logs accounting-api

# Nginxæ—¥å¿—
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

```bash
# æŸ¥çœ‹3001ç«¯å£å ç”¨
sudo lsof -i :3001
# æˆ–
sudo netstat -tulpn | grep 3001

# æ€æ­»å ç”¨è¿›ç¨‹
sudo kill -9 è¿›ç¨‹ID
```

### 2. æƒé™é—®é¢˜

```bash
# ç»™é¡¹ç›®æ–‡ä»¶å¤¹æƒé™
sudo chown -R $USER:$USER /var/www/accounting-system
```

### 3. æ•°æ®åº“æ–‡ä»¶ä½ç½®

SQLiteæ•°æ®åº“æ–‡ä»¶åœ¨ï¼š
```
backend/accounting.db
```

å¤‡ä»½æ•°æ®åº“ï¼š
```bash
cp backend/accounting.db backend/accounting.db.backup
```

### 4. é‡æ–°éƒ¨ç½²ï¼ˆæ›´æ–°ä»£ç ï¼‰

```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡æ–°æ„å»ºå‰ç«¯
npm run build

# é‡å¯åç«¯
pm2 restart accounting-api

# é‡å¯Nginx
sudo systemctl restart nginx
```

---

## ğŸ¯ éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œæ£€æŸ¥ï¼š

- [ ] åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸ï¼š`pm2 status`
- [ ] å¯ä»¥è®¿é—®å‰ç«¯é¡µé¢
- [ ] æ·»åŠ å®¢æˆ·ï¼Œåˆ·æ–°é¡µé¢ï¼Œæ•°æ®è¿˜åœ¨
- [ ] æŸ¥çœ‹åç«¯æ—¥å¿—æ— é”™è¯¯ï¼š`pm2 logs`
- [ ] Nginxè¿è¡Œæ­£å¸¸ï¼š`sudo systemctl status nginx`

---

## ğŸ” å®‰å…¨å»ºè®®ï¼ˆå¯é€‰ï¼‰

1. **é…ç½®HTTPS**
```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d ä½ çš„åŸŸå
```

2. **ä¿®æ”¹é»˜è®¤ç«¯å£**
ç¼–è¾‘ `backend/server.js`ï¼Œä¿®æ”¹ `PORT` å˜é‡

3. **è®¾ç½®é˜²ç«å¢™è§„åˆ™**
åªå¼€æ”¾å¿…è¦çš„ç«¯å£ï¼ˆ80, 443, 22ï¼‰

---

éœ€è¦å¸®åŠ©ï¼Ÿéšæ—¶è”ç³»å¼€å‘è€…ï¼

